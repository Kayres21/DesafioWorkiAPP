<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Desafio</title>
        <script src="js/jquery-3.5.1.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
        <script src = "https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" ></script>
    </head>
        <body>
            <div class="container">
                <h1 class ="titulo">Desafio practica</h1>
                <div class="row">
                    <div class="col">
                        <h4>Filtrar por rango de fechas</h4>
                        <div class="row">
                            <div class="col-12">
                                <h5>Fecha inicio</h5>
                                <div class="form-group">
                                    <div class='input-group date' >
                                       <input id='datetimepicker1' type='text' class="form-control" />
                                       <span class="input-group-addon">
                                       <span class="glyphicon glyphicon-calendar"></span>
                                       </span>
                                    </div>
                                 </div>

                            </div>
                            <div class="col-12">
                                <h5>Fecha de termino</h5>
                                <div class="form-group">
                                    <div class='input-group date' >
                                       <input id='datetimepicker2' type='text' class="form-control" />
                                       <span class="input-group-addon">
                                       <span class="glyphicon glyphicon-calendar"></span>
                                       </span>
                                    </div>
                                 </div>

                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <h4>Filtrar por nombre</h4>
                        <div class="row">
                            <div class="col-12">
                                <input id = "filtro_nombre" type="text" class="form-control" placeholder="Nombre" aria-label="Username" aria-describedby="basic-addon1">
                            </div>
                            
                        </div>
                    </div>
                </div>
                <div class = "row">
                    <div class="col"><button id = "filtrar_fecha" class="boton"  type = "button" >Buscar</button></div>
                    <div class="col"><button id = "filtrar_nombre" class="boton"  type = "button" >Buscar</button></div>
                </div>
                <div id = "resultados1" class="row">

                </div>
            </div>


            <script type="text/javascript">
                
                $(function () {
                    $('#datetimepicker1').datetimepicker({
                        format: "Y-m-d h:m:s",
                        formatDate: "Y-m-d"
                    });
                });
                $(function () {
                    $('#datetimepicker2').datetimepicker({
                        format: "Y-m-d h:m:s",
                        formatDate: "Y-m-d"
                    });
                });

                $("#filtrar_nombre").click(function(){
                var nombre =  $("#filtro_nombre").val()
                console.log(nombre)
                $.ajax({
                    type: 'GET',
                    url: 'http://localhost:3000/encuestas/nombre/' + nombre,
                    success: function(data){
                        console.log(data)
                        $("#resultados1").append(
                            "<div class = 'col-12'>"+ "La cantidad de fichas son = "  + data[0].count +"</div>"
                        )
                    }
                })
                }
                )

                $("#filtrar_fecha").click(function(){
                var fecha1 = $('#datetimepicker1').val();
                var fecha2 = $('#datetimepicker2').val();
                
                
                $.ajax({
                    type: 'POST',
                    url: 'http://localhost:3000/encuestas/rango',
                    data:{
                        tiempoSuperior: fecha2,
                        tiempoInferior: fecha1
                    },
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    cache:false,
                    success: function(data){    
                        console.log(data)
                    }
                })
                },

               
                

                )
               
            </script>



















          

        </body>
        <link rel="stylesheet" type="text/css" href="../frontend/datetimepicker-master/jquery.datetimepicker.css"/ >
        <script src="../frontend/datetimepicker-master/build/jquery.datetimepicker.full.min.js"></script>
    
</html>


<style>
    .titulo {
        text-align: center;
    }
    button{
        padding: 15px 30px;
        background-color: white;
        color: black;
        border: 2px solid #4CAF50 ;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        transition-duration: 0.4s;
        cursor: pointer;
    }
    .boton:hover{
        background-color: #4CAF50;
        color: white;
        
    }


    
</style>
